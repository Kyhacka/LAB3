open System

// Функция для ввода строк до достижения заданного количества
let inputStrings (count: int) =
    // Ленивая последовательность для ввода строк
    let rec readStrings (remaining: int) =
        seq {
            if remaining > 0 then
                printfn "Введите строку (осталось ввести %d строк):" remaining
                let input = Console.ReadLine()
                if not (String.IsNullOrEmpty(input)) then
                    yield input // Возвращаем строку, если она не пустая
                    yield! readStrings (remaining - 1) // Продолжаем ввод
        }
    readStrings count // Запускаем последовательность

// Функция для проверки, содержится ли цифра в строке
let containsDigit digit (str: string) =
    str.Contains(digit.ToString())

// Основная программа
let main () =
    // Ввод заданной цифры
    printfn "Введите цифру для поиска:"
    let targetDigit = 
        match Int32.TryParse(Console.ReadLine()) with
        | true, digit when digit >= 0 && digit <= 9 -> digit // Проверяем, что это одна цифра
        | _ -> 
            printfn "Некорректный ввод. Используется цифра по умолчанию: 0."
            0

    // Ввод количества строк
    printfn "Введите количество строк:"
    let count = 
        match Int32.TryParse(Console.ReadLine()) with
        | true, count when count > 0 -> count // Проверяем, что количество строк положительное
        | _ -> 
            printfn "Некорректный ввод. Используется значение по умолчанию: 3."
            3

    // Ввод строк с использованием ленивой последовательности
    let strings = inputStrings count

    // Используем Seq.fold для накопления суммы длин строк, содержащих заданную цифру
    let sum = 
        strings 
        |> Seq.fold (fun acc str ->
            if containsDigit targetDigit str then
                acc + str.Length // Добавляем длину строки к сумме, если цифра найдена
            else
                acc // Иначе оставляем сумму без изменений
        ) 0 // Начальное значение аккумулятора — 0

    // Выводим результат
    printfn "Сумма длин строк, содержащих цифру %d: %d" targetDigit sum

// Запуск программы
main()
